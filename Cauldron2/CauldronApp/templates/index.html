{% extends "base.html" %}

{% block navbar%}
    <nav class="navbar navbar-dark bg-dark shadow-sm mb-3">
      <a class="navbar-brand" href="#">
        Cauldron v2
      </a>

      {% if authenticated %}
      <div class="dropleft">
          <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ authenticated_username }}
          </a>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <a class="dropdown-item" href="/logout">Log out</a>
            <a target="_blank" rel="noreferrer noopener"class="dropdown-item text-danger" href="https://github.com/settings/connections/applications/{{ gh_client_id }}">Revoke access</a>
        </div>
      </div>
      {% endif %}
    </nav>
{% endblock %}

{% block content %}
    <div class="container">
      {% if not authenticated %}
      <div class="card shadow-sm mb-3">
        <div class="card-header">
          <h4 class="font-weight-normal">GitHub authentication</h4>
        </div>
        <div class="card-body">
          <form action="{{ gh_uri_identity }}" method="GET">
            <div class="from-group">
              <label>We need your token for analyzing your repository</label>
            </div>
            <input type="hidden" name="client_id" value="{{ gh_client_id }}">
            <button type="submit" class="btn btn-outline-primary">GitHub Login</button>
          </form>
        </div>
      </div>
      {% endif %}
      <div class="card shadow-sm mb-3">
        <div class="card-header">
          <h4 class="font-weight-normal">Dashboard</h4>
        </div>
        <div class="card-body">
          <form action="/create-dashboard" method="POST">
            {% csrf_token %}
            <div class="form-group">
              <label for="repositoryURL">Repository URL</label>
              <input type="text" name="url" class="form-control" id="repositoryURL" placeholder="Enter repository">
            </div>
            <button type="submit" class="btn btn-outline-primary">Get Dashboard</button>
          </form>
        </div>
      </div>
    </div>
{% endblock %}